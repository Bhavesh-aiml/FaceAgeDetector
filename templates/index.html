<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Face Age Predictor</title>
    <!-- Bootstrap CSS (Replit-themed) -->
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container py-4">
        <header class="text-center mb-5">
            <h1 class="display-4">Face Age Predictor</h1>
            <p class="lead">Upload an image or use your webcam to predict age from detected faces</p>
        </header>

        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card mb-4">
                    <div class="card-header">
                        <ul class="nav nav-tabs card-header-tabs" id="inputTypeTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="upload-tab" data-bs-toggle="tab" data-bs-target="#upload-tab-pane" type="button" role="tab" aria-controls="upload-tab-pane" aria-selected="true">
                                    <i class="fas fa-upload me-2"></i>Upload Image
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="webcam-tab" data-bs-toggle="tab" data-bs-target="#webcam-tab-pane" type="button" role="tab" aria-controls="webcam-tab-pane" aria-selected="false">
                                    <i class="fas fa-camera me-2"></i>Webcam
                                </button>
                            </li>
                        </ul>
                    </div>
                    <div class="card-body">
                        <div class="tab-content" id="inputTypeTabsContent">
                            <!-- Upload Tab -->
                            <div class="tab-pane fade show active" id="upload-tab-pane" role="tabpanel" aria-labelledby="upload-tab" tabindex="0">
                                <div class="dropzone-container">
                                    <div id="upload-dropzone" class="dropzone">
                                        <i class="fas fa-cloud-upload-alt fa-3x mb-3"></i>
                                        <p>Drag & drop an image here, or click to select</p>
                                        <input type="file" id="file-input" accept="image/*" hidden>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Webcam Tab -->
                            <div class="tab-pane fade" id="webcam-tab-pane" role="tabpanel" aria-labelledby="webcam-tab" tabindex="0">
                                <div class="webcam-container text-center">
                                    <video id="webcam" autoplay playsinline width="100%" class="rounded"></video>
                                    <div class="mt-3">
                                        <button id="start-webcam-btn" class="btn btn-primary me-2">
                                            <i class="fas fa-video me-2"></i>Start Camera
                                        </button>
                                        <button id="capture-btn" class="btn btn-success" disabled>
                                            <i class="fas fa-camera me-2"></i>Capture Photo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Preview and Results Section -->
                <div id="preview-section" class="card mb-4 d-none">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-image me-2"></i>Preview & Results
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="image-container position-relative">
                            <img id="preview-image" class="img-fluid rounded" alt="Preview">
                            <div id="face-markers"></div>
                            
                            <!-- Loading Overlay -->
                            <div id="loading-overlay" class="position-absolute top-0 start-0 w-100 h-100 d-flex justify-content-center align-items-center bg-dark bg-opacity-75 rounded d-none">
                                <div class="text-center">
                                    <img src="{{ url_for('static', filename='assets/loading.svg') }}" alt="Loading..." width="60" class="mb-3">
                                    <p class="text-white mb-0">Analyzing faces...</p>
                                </div>
                            </div>
                        </div>

                        <div id="analysis-results" class="mt-4 d-none">
                            <h5 class="mb-3">Age Prediction Results</h5>
                            <div id="results-content"></div>
                        </div>

                        <div id="error-message" class="alert alert-danger mt-3 d-none"></div>

                        <div class="mt-4">
                            <button id="analyze-btn" class="btn btn-primary" disabled>
                                <i class="fas fa-brain me-2"></i>Analyze Face
                            </button>
                            <button id="reset-btn" class="btn btn-outline-secondary">
                                <i class="fas fa-redo me-2"></i>Start Over
                            </button>
                        </div>
                    </div>
                </div>

                <!-- How It Works Section -->
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-info-circle me-2"></i>How It Works
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <div class="text-center mb-2">
                                    <i class="fas fa-upload fa-2x text-primary"></i>
                                </div>
                                <h6 class="text-center">Upload or Capture</h6>
                                <p class="small text-center">Upload an image or capture one with your webcam.</p>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="text-center mb-2">
                                    <i class="fas fa-face-smile fa-2x text-primary"></i>
                                </div>
                                <h6 class="text-center">Face Detection</h6>
                                <p class="small text-center">Advanced algorithms detect faces in images with high accuracy.</p>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="text-center mb-2">
                                    <i class="fas fa-chart-bar fa-2x text-primary"></i>
                                </div>
                                <h6 class="text-center">Age Prediction</h6>
                                <p class="small text-center">Computer vision analyzes facial features to predict age.</p>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="text-center mb-2">
                                    <i class="fas fa-video fa-2x text-primary"></i>
                                </div>
                                <h6 class="text-center">Live Detection</h6>
                                <p class="small text-center">Try real-time face detection with your webcam.</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Advanced Features Section -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="fas fa-star me-2"></i>Features & Tips
                        </h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h6><i class="fas fa-magic me-2 text-primary"></i>Live Detection</h6>
                                <p class="small">Use the webcam's "Live Detection" feature to continuously analyze faces in real-time.</p>
                                
                                <h6 class="mt-3"><i class="fas fa-users me-2 text-primary"></i>Multiple Face Detection</h6>
                                <p class="small">Our app can detect and analyze multiple faces in a single image simultaneously.</p>
                            </div>
                            <div class="col-md-6">
                                <h6><i class="fas fa-lightbulb me-2 text-primary"></i>Best Results Tips</h6>
                                <ul class="small">
                                    <li>Ensure faces are well-lit and clearly visible</li>
                                    <li>For webcam use, face the camera directly</li>
                                    <li>Avoid extreme angles for better detection</li>
                                    <li>Remove sunglasses or items covering facial features</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="py-3 mt-4 text-center">
        <p>Built with <i class="fas fa-heart text-danger"></i> using Flask, OpenCV, and DeepFace</p>
    </footer>

    <!-- Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
